<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MENÃš CAPIBOBBA - WhatsApp Optimized</title>
    
    <!-- Enlace al archivo CSS externo -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Fonts: Preconnect para mejorar la velocidad de descarga -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Fonts: Precarga y estilos para Nunito y Balsamiq Sans -->
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:wght@700&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
</head>
<body>
    <!-- Burbujas de fondo animadas (elementos puramente decorativos) -->
    <div class="bubbles-background" aria-hidden="true">
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
        <span class="bubble"></span>
    </div>

    <!-- Contenedor principal de decoraciones kawaii flotantes (puramente decorativas) -->
    <div class="kawaii-decorations-wrapper" aria-hidden="true">
        <span class="kawaii-decoration bubble-tea-cup">ğŸ§‹</span>
        <span class="kawaii-decoration capybara-float-1">ğŸ¦«</span>
        <span class="kawaii-decoration capybara-float-2">ğŸ¦«</span>
        <span class="kawaii-decoration heart-float">ğŸ’–</span>
    </div>
    
    <!-- Contenedor principal de todo el contenido del menÃº -->
    <main class="menu-container">
        <!-- Encabezado principal de la pÃ¡gina -->
        <header class="header">
            <div class="capybobba-mascot" role="img" aria-label="Capibobba Logo con un corazÃ³n flotante">
                <!-- ImÃ¡genes del logo con atributos de rendimiento y accesibilidad -->
                <img id="logoLight" src="https://i.imgur.com/llR0NN0.png" alt="Capibobba Logo Modo Claro" width="250" height="250" loading="eager">
                <img id="logoDark" src="https://i.imgur.com/i7psA3z.png" alt="Capibobba Logo Modo Oscuro" width="250" height="250" loading="eager">
            </div>
            <h1 class="main-title">MENÃš CAPIBOBBA</h1>
            <p class="tagline">Â¡Dale un abrazo a tu bebida favorita! ğŸ§¸ğŸ’•</p>

            <!-- Resumen del carrito flotante en el header -->
            <div class="cart-summary" id="cartSummary" role="status" aria-live="polite" tabindex="0">
                <span class="cart-icon-emoji" id="cartIconEmoji" aria-hidden="true">ğŸ›’</span>
                <span class="cart-item-count" id="cartItemCount">0</span>
                <span class="visually-hidden">elementos en el carrito</span>
            </div>

            <!-- BotÃ³n de administraciÃ³n de productos -->
            <button id="openAdminPanelButton" class="admin-button" style="display: none;">
                Administrar Productos âš™ï¸
            </button>
        </header>
        
        <!-- SecciÃ³n de Bebidas FrÃ­as (FrappÃ©s de Agua) -->
        <section class="menu-section animate-slide-in-left">
            <h2 class="section-title">ğŸ’§ FrappÃ©s de Agua ğŸ’§</h2>
            <div class="flavor-grid" id="waterFrappesGrid">
                <!-- Los productos se cargarÃ¡n aquÃ­ dinÃ¡micamente desde Firestore -->
            </div>
        </section>

        <!-- SecciÃ³n de Bebidas FrÃ­as (FrappÃ©s de Leche) -->
        <section class="menu-section animate-slide-in-right">
            <h2 class="section-title">ğŸ¥› FrappÃ©s de Leche ğŸ¥›</h2>
            <div class="flavor-grid" id="milkFrappesGrid">
                <!-- Los productos se cargarÃ¡n aquÃ­ dinÃ¡micamente desde Firestore -->
            </div>
        </section>

        <!-- PromociÃ³n Especial: Chamoyada -->
        <section class="promotion-section animate-on-scroll" id="chamoyadaPromotion" style="display: none;">
            <div class="promotion-content">
                <h2 class="promotion-item-title">ğŸŒ¶ï¸ğŸ¥­ Â¡Nueva! Especialidad: Chamoyada ğŸ¥­ğŸŒ¶ï¸</h2>
                <p class="promotion-item-description">Refrescante frappÃ© con un toque picosito de chamoy y el sabor de tu fruta favorita. Â¡PersonalÃ­zala!</p>
                <div class="promotion-actions">
                    <button class="add-drink-to-cart-button" data-name="Chamoyada" data-price="75" aria-label="AÃ±adir Chamoyada al carrito">Â¡La quiero! ğŸ¤¤</button>
                </div>
            </div>
        </section>

        <!-- PromociÃ³n Especial: FrappÃ© Fresas con Crema (Temporada) -->
        <section class="promotion-section animate-on-scroll" id="fresasConCremaPromotion" style="display: none;">
            <div class="promotion-content">
                <h2 class="promotion-item-title">ğŸ“ğŸ¥› FrappÃ© de Temporada: "Fresas con Crema" ğŸ“ğŸ¥›</h2>
                <p class="promotion-item-description">La combinaciÃ³n perfecta de fresas frescas y la suavidad de la crema en un delicioso frappÃ©. Â¡Solo por tiempo limitado!</p>
                <div class="promotion-actions">
                    <button class="add-drink-to-cart-button" data-name="FrappÃ© Fresas con Crema (Temporada)" data-price="65" aria-label="AÃ±adir FrappÃ© Fresas con Crema al carrito">Â¡PruÃ©balo! ğŸ˜‹</button>
                </div>
            </div>
        </section>

        <!-- SecciÃ³n de Bebidas Calientes -->
        <section class="menu-section animate-slide-in-left">
            <h2 class="section-title">â˜• Bebidas Calientes â˜•</h2>
            <div class="flavor-grid" id="hotDrinksGrid">
                <!-- Los productos se cargarÃ¡n aquÃ­ dinÃ¡micamente desde Firestore -->
            </div>
        </section>

        <!-- SecciÃ³n del Carrito de Compras -->
        <section class="shopping-cart-section animate-on-scroll" id="shoppingCartSection">
            <h2 class="section-title">Mi Carrito ğŸ›ï¸</h2>
            <ul id="cartItemsList" class="cart-items-list">
                <!-- Los elementos del carrito se aÃ±adirÃ¡n aquÃ­ dinÃ¡micamente -->
                <li class="empty-cart-message">Â¡Tu carrito estÃ¡ vacÃ­o, aÃ±ade algo delicioso! ğŸ’–</li>
            </ul>
            <div class="cart-total" id="cartTotal">Total: $0.00</div>
            <div class="cart-actions">
                <button id="clearCartButton" class="clear-cart-button" disabled>Vaciar Carrito ğŸ—‘ï¸</button>
                <button id="orderWhatsAppButton" class="order-whatsapp-button" disabled>Pedir por WhatsApp ğŸ“±</button>
            </div>
        </section>

        <!-- Contador de Visitantes (visible solo para el desarrollador) -->
        <div id="visitorCounterDisplay" class="visitor-counter-display" style="display: none;">
            <span>Visitantes Ãºnicos: <span id="visitorCount">0</span></span>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 Capibobba. Todos los derechos reservados. Hecho con ğŸ’– y Capibaras.</p>
        </footer>
    </main>

    <!-- Modal para mostrar imagen de sabor -->
    <div id="flavorImageOverlay" class="flavor-image-overlay">
        <div class="flavor-image-modal-content">
            <button class="close-modal-button" aria-label="Cerrar modal de imagen">âœ–ï¸</button>
            <h3 id="flavorImageName" class="modal-title"></h3>
            <img id="flavorImage" src="" alt="Imagen de sabor" class="flavor-modal-image">
        </div>
    </div>

    <!-- Modal para selecciÃ³n de toppings -->
    <div id="toppingSelectionOverlay" class="topping-selection-overlay">
        <div class="topping-selection-modal-content">
            <button class="close-modal-button" aria-label="Cerrar modal de toppings">âœ–ï¸</button>
            <h3 class="modal-title">Personaliza tu <span id="toppingDrinkName"></span></h3>
            <p class="modal-subtitle">AÃ±ade tus toppings favoritos:</p>
            <div id="toppingsModalGrid" class="toppings-modal-grid">
                <!-- Toppings se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
            </div>
            <div class="modal-actions">
                <button id="confirmToppingsButton" class="confirm-button">Confirmar SelecciÃ³n âœ…</button>
                <button id="noToppingsButton" class="no-toppings-button">Sin Toppings ğŸš«</button>
                <button id="cancelToppingsButton" class="cancel-button">Cancelar âŒ</button>
            </div>
        </div>
    </div>

    <!-- Modal para personalizaciÃ³n de Chamoyada -->
    <div id="chamoyadaCustomizationOverlay" class="chamoyada-customization-overlay">
        <div class="chamoyada-customization-modal-content">
            <button class="close-modal-button" aria-label="Cerrar modal de Chamoyada">âœ–ï¸</button>
            <h3 class="modal-title">Personaliza tu Chamoyada ğŸ¥­ğŸŒ¶ï¸</h3>
            <p class="modal-subtitle">1. Elige tu sabor base:</p>
            <div id="chamoyadaBaseFlavorGrid" class="chamoyada-base-flavor-grid">
                <!-- Sabores base se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
            </div>
            <p class="modal-subtitle">2. AÃ±ade toppings (opcional):</p>
            <div id="chamoyadaToppingsGrid" class="toppings-modal-grid">
                <!-- Toppings se cargarÃ¡n aquÃ­ dinÃ¡micamente -->
            </div>
            <div class="modal-actions">
                <button id="confirmChamoyadaButton" class="confirm-button">AÃ±adir Chamoyada al Carrito âœ…</button>
                <button id="cancelChamoyadaButton" class="cancel-button">Cancelar âŒ</button>
            </div>
        </div>
    </div>

    <!-- Modal para el panel de administraciÃ³n de productos -->
    <div id="adminPanelOverlay" class="admin-panel-overlay">
        <div class="admin-panel-content">
            <button class="close-modal-button" aria-label="Cerrar panel de administraciÃ³n">âœ–ï¸</button>
            <h2 class="modal-title">âš™ï¸ AdministraciÃ³n de Productos âš™ï¸</h2>

            <form id="productForm" class="product-form">
                <input type="hidden" id="productId">
                
                <div class="form-group">
                    <label for="productType">Tipo de Producto:</label>
                    <select id="productType" required>
                        <option value="">Selecciona un tipo</option>
                        <option value="water-based-frappe">FrappÃ© de Agua</option>
                        <option value="milk-based-frappe">FrappÃ© de Leche</option>
                        <option value="hot-drink">Bebida Caliente</option>
                        <option value="promotion">PromociÃ³n (Chamoyada/Fresas con Crema)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="productName">Nombre Interno (ej. "Fresa"):</label>
                    <input type="text" id="productName" placeholder="Nombre Ãºnico del producto" required>
                </div>
                
                <div class="form-group">
                    <label for="productDisplayName">Nombre para Mostrar (ej. "FrappÃ© de Fresa"):</label>
                    <input type="text" id="productDisplayName" placeholder="Nombre visible en el menÃº" required>
                </div>
                
                <div class="form-group">
                    <label for="productPrice">Precio:</label>
                    <input type="number" id="productPrice" step="0.01" placeholder="Ej. 65.00" required>
                </div>
                
                <div class="form-group">
                    <label for="productDescription">DescripciÃ³n:</label>
                    <textarea id="productDescription" placeholder="Breve descripciÃ³n del producto" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="productImageUrl">URL de Imagen:</label>
                    <input type="url" id="productImageUrl" placeholder="URL de la imagen del producto">
                </div>
                
                <div class="form-actions">
                    <button type="submit" id="saveProductButton" class="confirm-button">Guardar Producto âœ¨</button>
                    <button type="button" id="cancelEditButton" class="cancel-button">Limpiar Formulario ğŸ”„</button>
                </div>
            </form>

            <h3 class="admin-list-title">Productos Actuales</h3>
            <ul id="adminProductsList" class="admin-products-list">
                <!-- Los productos se listarÃ¡n aquÃ­ para ediciÃ³n/eliminaciÃ³n -->
            </ul>
        </div>
    </div>

    <!-- Enlace al archivo JavaScript externo (siempre al final del body) -->
    <script type="module" src="script.js"></script>
</body>
</html>
